sequenceDiagram
    participant C as Client
    participant R as Router
    participant RL as Forgot Limiter
    participant RS as Redis Store
    participant H as Forgot Handler

    C->>R: POST /api/v1/auth/local/password/forgot
    R->>RL: Apply forgot limiter middleware
    alt RATE_LIMIT_REDIS_ENABLED and redis client present
        RL->>RS: INCR window key (ip scoped)
        RS-->>RL: count + ttl
    else fallback path
        RL->>RL: Local fixed-window check
    end
    alt over limit or backend error in fail-closed mode
        RL-->>C: 429 RATE_LIMITED (Retry-After + X-RateLimit-*)
    else allowed
        RL->>H: pass request (+ X-RateLimit-*)
        H-->>C: 200 generic response (+ X-RateLimit-*)
    end
